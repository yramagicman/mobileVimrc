#!/usr/bin/env python2
import sqlite3
import os
home = os.path.expanduser('~')
config = open(home + "/.config/ffclean")
domains = []
# Read config file
count = 0
for line in config:
    if count < 1:
        # Extract user cookie file path
        path = line
    else:
        # Add domains to the query
        domains.append(line.strip())
    count = count + 1
# Start queries
delete = ['delete', 'from', 'moz_cookies', 'where']
select = ['select', '*', 'from', 'moz_cookies', 'where']
# loop through file and extract relavent data
for i in domains:
    delete.append('baseDomain <> "' + i + '" AND ')
    select.append('baseDomain <> "' + i + '" AND ')
# Create queries by joining lists
d = " ".join(delete)
s = " ".join(select)
# Trim AND off the end of the list.
s = s[:-4]
d = d[:-4]
# Connect to the sqlite3 database
con = sqlite3.connect(path.strip())
c = con.cursor()
# Delete stuff and make sure it's gone
c.execute(d)
c.execute(s)
count = 0
for i in c.fetchall():
    print i
    count = count + 1
print count
